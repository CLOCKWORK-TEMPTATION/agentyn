Add this sanitize function at the start of generateHTMLReport method:

const sanitize = (s: string) => s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');

Then wrap all user data with sanitize():
- ${sanitize(report.script_title)}
- ${sanitize(report.emotional_analysis.overall_tone)}
- ${sanitize(report.emotional_analysis.director_vision)}
- ${sanitize(element.name)}
- ${sanitize(element.category)}
- ${sanitize(element.description)}
- ${sanitize(decision.conflict_type)}
- ${sanitize(decision.resolution)}
- ${sanitize(decision.reasoning.join(', '))}
